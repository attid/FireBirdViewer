# Техническое задание: Web-администратор Firebird SQL

## 1. Общие положения
**Цель проекта:** Создание легковесного веб-приложения для администрирования баз данных Firebird SQL (аналог IBExpert/phpMyAdmin).
**Формат поставки:** Docker-контейнер и единый бинарный файл.
**Тип лицензии:** Внутренний продукт с перспективой выхода в Open Source (MIT/Apache 2.0).

## 2. Технологический стек
Выбран стек, обеспечивающий максимальную производительность, малый размер образа и удобство разработки («Vibe Stack»).

### 2.1 Backend
* **Язык:** Go (Golang) версии 1.22+.
* **Web Framework:** Echo (или Fiber).
* **Драйвер Firebird:** `github.com/nakagami/firebirdsql` (Pure Go, без зависимости от fbclient.so).
* **Внутренняя БД (хранение настроек):** SQLite (драйвер modernc.org/sqlite или go-sqlite3).
* **ORM (для SQLite):** GORM.

### 2.2 Frontend
* **Фреймворк:** Vue 3 (Composition API).
* **Сборщик:** Vite.
* **UI Library:** PrimeVue 4 (тема Aura/Lara).
    * *Ключевое требование:* Использование VirtualScroller в таблицах для работы с большими данными без лагов.
* **State Management:** Pinia.
* **Редактор кода:** Monaco Editor (или облегченный аналог CodeMirror) для SQL.

### 2.3 Инфраструктура
* **Docker:** Multi-stage сборка.
* **Base Image:** Alpine Linux или Scratch.
* **Целевой размер образа:** < 50 MB (в сжатом виде).

---

## 3. Архитектура приложения

### 3.1 Модель работы с данными
Приложение поддерживает два режима работы (гибридная модель):

1.  **Stateless ("Режим Adminer"):**
    * Пользователь вводит `Host`, `Path`, `User`, `Password` на экране входа.
    * Система не сохраняет эти данные на диске.
    * Сессия живет, пока открыта вкладка или жив JWT токен.
2.  **Stateful ("Режим Workspace"):**
    * Пользователь авторизуется в самом приложении (локальный админ).
    * Есть список сохраненных серверов (Alias, Host, Path).
    * Пароли к серверам Firebird хранятся в зашифрованном виде (AES-GCM) в локальной SQLite базе.

### 3.2 Безопасность
* Пароли от подключений Firebird никогда не передаются на фронтенд в открытом виде.
* Все API запросы защищены JWT токеном.

---

## 4. Функциональные требования

### 4.1 Управление подключениями
* Экран логина с выбором: "Быстрое подключение" или "Вход в аккаунт".
* CRUD (Create, Read, Update, Delete) для списка сохраненных баз данных (в режиме Workspace).
* Проверка соединения (Ping).

### 4.2 Навигация (Object Browser)
* Древовидная структура слева:
    * Таблицы (Tables)
    * Представления (Views)
    * Процедуры (Procedures)
    * Триггеры (Triggers)
    * Генераторы (Generators/Sequences)
* Поиск/Фильтрация по дереву объектов.

### 4.3 Работа с данными (Data Grid)
* Просмотр содержимого таблиц.
* **Пагинация:** Виртуальный скроллинг (Virtual Scroll) вместо классических страниц "1, 2, 3".
* **Сортировка:** По клику на заголовок колонки.
* **Фильтрация:** Простые фильтры по колонкам.
* **Редактирование:**
    * Inline-редактирование ячеек (по возможности).
    * Или кнопка "Edit" -> модальное окно с формой записи.
* Удаление записей.
* Экспорт данных (CSV/JSON).

### 4.4 SQL Редактор
* Поле для ввода произвольных SQL запросов.
* Подсветка синтаксиса SQL.
* История запросов (сохраняется в `localStorage` браузера).
* Вывод результатов в таблицу (Grid).
* Вывод сообщений об ошибках от сервера Firebird.

### 4.5 Редактор Метаданных (DDL)
* Просмотр DDL скрипта существующего объекта ("Show Create Table").
* Создание новых таблиц (простой визуальный интерфейс: Имя, Колонки, Типы).
* Редактирование таблиц (Добавление/Удаление полей).
* Редактирование исходного кода Процедур и Триггеров.
* **Ограничение:** Визуальный конструктор сложных SQL-запросов (Query Builder) **не требуется**.

---

## 5. Требования к интерфейсу (UI/UX)
* **Тема:** Поддержка Темной (Dark) и Светлой (Light) темы. Переключение автоматическое или вручную.
* **Отзывчивость:** Интерфейс не должен блокироваться при выполнении долгих запросов (индикаторы загрузки/скелетоны).
* **Стиль:** Минимализм, плоский дизайн (Flat), акцент на рабочей области данных.

---

## 6. Этапы разработки (Roadmap)

1.  **MVP (Minimum Viable Product):**
    * Настройка репозитория и Docker.
    * Режим "Быстрое подключение".
    * Просмотр списка таблиц.
    * Выполнение произвольного SQL (SELECT).
    * Отображение результатов в таблице.
2.  **Версия 0.5 (Data Management):**
    * Внедрение PrimeVue VirtualScroller.
    * Редактирование/Удаление данных в таблицах.
    * Просмотр DDL.
3.  **Версия 1.0 (Release):**
    * Внедрение SQLite и режима "Workspace" (сохраненные подключения).
    * Шифрование паролей.
    * Редакторы процедур/триггеров.
    * Финальная полировка UI.

